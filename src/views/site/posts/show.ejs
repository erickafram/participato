<%- include('../layouts/main', { body: `
<article class="post-article">
  <div class="container">
    <!-- Header do Post -->
    <header class="post-header">
      <nav class="post-breadcrumb">
        <a href="/">Início</a>
        <span>/</span>
        <a href="/noticias">Notícias</a>
        ${post.category ? '<span>/</span><a href="/categoria/' + post.category.slug + '">' + post.category.name + '</a>' : ''}
      </nav>
      
      ${post.category ? '<a href="/categoria/' + post.category.slug + '" class="post-category-badge" style="background: ' + post.category.color + '">' + post.category.name + '</a>' : ''}
      
      <h1 class="post-title">${post.title}</h1>
      
      ${post.subtitle ? '<p class="post-subtitle">' + post.subtitle + '</p>' : ''}
      
      <div class="post-meta">
        ${post.author ? `
          <div class="post-author">
            ${post.author.avatar 
              ? '<img src="' + post.author.avatar + '" alt="' + post.author.name + '" class="author-avatar">'
              : '<div class="author-avatar-placeholder">' + post.author.name.charAt(0) + '</div>'
            }
            <span>${post.author.name}</span>
          </div>
        ` : ''}
        <span class="meta-divider">•</span>
        <time>${new Date(post.published_at || post.created_at).toLocaleDateString('pt-BR', { day: 'numeric', month: 'long', year: 'numeric' })}</time>
        <span class="meta-divider">•</span>
        <span>${post.views.toLocaleString('pt-BR')} views</span>
      </div>
    </header>

    <div class="post-layout">
      <!-- Conteúdo Principal -->
      <main class="post-main">
        ${post.featured_image ? `
          <figure class="post-featured-image">
            <img src="${post.featured_image}" alt="${post.featured_image_alt || post.title}">
          </figure>
        ` : ''}
        
        <div class="post-content">
          ${post.content}
        </div>
        
        <!-- Tags -->
        ${post.tags && post.tags.length > 0 ? `
          <div class="post-tags">
            ${post.tags.map(tag => '<a href="/tag/' + tag.trim() + '">#' + tag.trim() + '</a>').join('')}
          </div>
        ` : ''}
        
        <!-- Compartilhar -->
        <div class="post-share">
          <span>Compartilhar:</span>
          <div class="share-buttons">
            <a href="https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(siteUrl + '/noticia/' + post.slug)}" target="_blank" class="share-btn facebook" title="Facebook">
              <i class="bi bi-facebook"></i>
            </a>
            <a href="https://twitter.com/intent/tweet?url=${encodeURIComponent(siteUrl + '/noticia/' + post.slug)}&text=${encodeURIComponent(post.title)}" target="_blank" class="share-btn twitter" title="Twitter">
              <i class="bi bi-twitter-x"></i>
            </a>
            <a href="https://wa.me/?text=${encodeURIComponent(post.title + ' - ' + siteUrl + '/noticia/' + post.slug)}" target="_blank" class="share-btn whatsapp" title="WhatsApp">
              <i class="bi bi-whatsapp"></i>
            </a>
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(siteUrl + '/noticia/' + post.slug)}" target="_blank" class="share-btn linkedin" title="LinkedIn">
              <i class="bi bi-linkedin"></i>
            </a>
          </div>
        </div>

        <!-- Autor -->
        ${post.author && post.author.bio ? `
          <div class="author-box">
            ${post.author.avatar 
              ? '<img src="' + post.author.avatar + '" alt="' + post.author.name + '" class="author-box-avatar">'
              : '<div class="author-box-avatar-placeholder">' + post.author.name.charAt(0) + '</div>'
            }
            <div class="author-box-info">
              <span class="author-label">Escrito por</span>
              <h4>${post.author.name}</h4>
              <p>${post.author.bio}</p>
            </div>
          </div>
        ` : ''}

        <!-- Posts Relacionados -->
        ${relatedPosts && relatedPosts.length > 0 ? `
          <section class="related-posts">
            <h3>Leia também</h3>
            <div class="related-grid">
              ${relatedPosts.map(related => `
                <a href="/noticia/${related.slug}" class="related-item">
                  <img src="${related.featured_image || '/images/placeholder.jpg'}" alt="${related.title}">
                  <div class="related-info">
                    <h4>${related.title}</h4>
                    <time>${new Date(related.published_at || related.created_at).toLocaleDateString('pt-BR')}</time>
                  </div>
                </a>
              `).join('')}
            </div>
          </section>
        ` : ''}
      </main>

      <!-- Sidebar -->
      <aside class="post-sidebar">
        <!-- Mais Lidas -->
        <div class="sidebar-box">
          <h3>Mais Lidas</h3>
          <div class="popular-list">
            ${popularPosts && popularPosts.length > 0 
              ? popularPosts.map((popular, index) => `
                <a href="/noticia/${popular.slug}" class="popular-item">
                  <span class="popular-number">${String(index + 1).padStart(2, '0')}</span>
                  <div class="popular-info">
                    <h4>${popular.title}</h4>
                    <span>${popular.views.toLocaleString('pt-BR')} views</span>
                  </div>
                </a>
              `).join('')
              : '<p class="empty-message">Nenhum post encontrado.</p>'
            }
          </div>
        </div>
        
        <!-- Categorias -->
        <div class="sidebar-box">
          <h3>Categorias</h3>
          <div class="categories-list">
            ${categories.map(cat => `
              <a href="/categoria/${cat.slug}" class="category-link">
                <span class="category-dot" style="background: ${cat.color}"></span>
                <span class="category-name">${cat.name}</span>
                <span class="category-count">${cat.postCount || 0}</span>
              </a>
            `).join('')}
          </div>
        </div>
      </aside>
    </div>
  </div>
</article>
`}) %>
