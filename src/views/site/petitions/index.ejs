<%- include('../layouts/main', { body: `

<div class="petitions-hero">
  <div class="container">
    <h1><i class="bi bi-megaphone-fill"></i> Petições</h1>
    <p>Faça sua voz ser ouvida. Assine petições e apoie causas importantes.</p>
    <a href="/criar-peticao" class="btn-create-petition">
      <i class="bi bi-plus-circle"></i> Crie sua Petição
    </a>
  </div>
</div>

<div class="container py-4">
  <!-- Filtros -->
  <div class="filters-section">
    <form method="GET" class="filters-form">
      <div class="filter-categories">
        <a href="/peticoes" class="filter-btn ${!category ? 'active' : ''}">Todas</a>
        ${(petitionCategories || []).map(cat => 
          '<a href="/peticoes?category=' + encodeURIComponent(cat) + '" class="filter-btn ' + (category === cat ? 'active' : '') + '">' + cat + '</a>'
        ).join('')}
      </div>
      <div class="search-box">
        <input type="text" name="search" placeholder="Buscar petições..." value="${search || ''}">
        <button type="submit"><i class="bi bi-search"></i></button>
      </div>
    </form>
  </div>

  <!-- Lista de Petições -->
  ${petitions && petitions.length > 0 ? 
    '<div class="petitions-grid">' +
    petitions.map(petition => {
      const progress = Math.min(100, Math.round((petition.signatureCount / petition.goal) * 100));
      return '<article class="petition-card">' +
        (petition.featured ? '<span class="featured-badge"><i class="bi bi-star-fill"></i> Destaque</span>' : '') +
        '<a href="/peticao/' + petition.slug + '" class="petition-image">' +
          (petition.image ? '<img src="' + petition.image + '" alt="' + petition.title + '">' : '<div class="placeholder-image"><i class="bi bi-megaphone"></i></div>') +
        '</a>' +
        '<div class="petition-content">' +
          (petition.category ? '<span class="petition-category">' + petition.category + '</span>' : '') +
          '<h2><a href="/peticao/' + petition.slug + '">' + petition.title + '</a></h2>' +
          '<p>' + petition.description.substring(0, 120) + (petition.description.length > 120 ? '...' : '') + '</p>' +
          '<div class="petition-progress">' +
            '<div class="progress-bar"><div class="progress-fill" style="width: ' + progress + '%"></div></div>' +
            '<div class="progress-info">' +
              '<span class="signatures-count"><strong>' + petition.signatureCount.toLocaleString('pt-BR') + '</strong> assinaturas</span>' +
              '<span class="goal">Meta: ' + petition.goal.toLocaleString('pt-BR') + '</span>' +
            '</div>' +
          '</div>' +
          '<a href="/peticao/' + petition.slug + '" class="btn-sign">Assinar Petição</a>' +
        '</div>' +
      '</article>';
    }).join('') +
    '</div>' +
    (totalPages > 1 ? 
      '<nav class="pagination-nav">' +
        (currentPage > 1 ? '<a href="/peticoes?page=' + (currentPage - 1) + (category ? '&category=' + encodeURIComponent(category) : '') + (search ? '&search=' + encodeURIComponent(search) : '') + '" class="page-link"><i class="bi bi-chevron-left"></i> Anterior</a>' : '') +
        '<span class="page-info">Página ' + currentPage + ' de ' + totalPages + '</span>' +
        (currentPage < totalPages ? '<a href="/peticoes?page=' + (currentPage + 1) + (category ? '&category=' + encodeURIComponent(category) : '') + (search ? '&search=' + encodeURIComponent(search) : '') + '" class="page-link">Próxima <i class="bi bi-chevron-right"></i></a>' : '') +
      '</nav>' : '')
  : 
    '<div class="empty-state">' +
      '<i class="bi bi-megaphone"></i>' +
      '<h3>Nenhuma petição encontrada</h3>' +
      '<p>Não há petições ativas no momento' + (search ? ' para sua busca' : '') + '.</p>' +
      (search || category ? '<a href="/peticoes" class="btn btn-primary">Ver todas as petições</a>' : '') +
    '</div>'
  }
</div>

<style>
  .petitions-hero {
    background: linear-gradient(135deg, var(--primary-color, #3b82f6) 0%, #1d4ed8 100%);
    color: #fff;
    padding: 60px 0;
    text-align: center;
  }
  .petitions-hero h1 {
    font-size: 2.5rem;
    font-weight: 800;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
  }
  .petitions-hero p {
    font-size: 1.1rem;
    opacity: 0.9;
    max-width: 600px;
    margin: 0 auto 20px;
  }
  .btn-create-petition {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 14px 28px;
    background: #fff;
    color: var(--primary-color, #3b82f6);
    border-radius: 50px;
    font-size: 15px;
    font-weight: 700;
    text-decoration: none;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  }
  .btn-create-petition:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    color: #1d4ed8;
  }
  .btn-create-petition i {
    font-size: 18px;
  }
  .filters-section {
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 24px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  .filters-form {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    align-items: center;
    justify-content: space-between;
  }
  .filter-categories {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }
  .filter-btn {
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 500;
    text-decoration: none;
    color: #64748b;
    background: #f1f5f9;
    transition: all 0.2s;
  }
  .filter-btn:hover, .filter-btn.active {
    background: var(--primary-color, #3b82f6);
    color: #fff;
  }
  .search-box {
    display: flex;
    min-width: 250px;
  }
  .search-box input {
    flex: 1;
    padding: 10px 14px;
    border: 1px solid #e2e8f0;
    border-radius: 8px 0 0 8px;
    font-size: 14px;
  }
  .search-box input:focus {
    outline: none;
    border-color: var(--primary-color, #3b82f6);
  }
  .search-box button {
    padding: 10px 16px;
    background: var(--primary-color, #3b82f6);
    color: #fff;
    border: none;
    border-radius: 0 8px 8px 0;
    cursor: pointer;
  }
  .petitions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 24px;
  }
  .petition-card {
    background: #fff;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    transition: transform 0.2s, box-shadow 0.2s;
    position: relative;
  }
  .petition-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.12);
  }
  .featured-badge {
    position: absolute;
    top: 12px;
    left: 12px;
    background: #f59e0b;
    color: #fff;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
    z-index: 1;
    display: flex;
    align-items: center;
    gap: 4px;
  }
  .petition-image {
    display: block;
    height: 180px;
    overflow: hidden;
  }
  .petition-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s;
  }
  .petition-card:hover .petition-image img {
    transform: scale(1.05);
  }
  .placeholder-image {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #e2e8f0 0%, #f1f5f9 100%);
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .placeholder-image i {
    font-size: 48px;
    color: #94a3b8;
  }
  .petition-content {
    padding: 20px;
  }
  .petition-category {
    display: inline-block;
    background: #eff6ff;
    color: var(--primary-color, #3b82f6);
    padding: 4px 10px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
    margin-bottom: 10px;
  }
  .petition-content h2 {
    font-size: 1.1rem;
    font-weight: 700;
    margin: 0 0 10px;
    line-height: 1.4;
  }
  .petition-content h2 a {
    color: #0f172a;
    text-decoration: none;
  }
  .petition-content h2 a:hover {
    color: var(--primary-color, #3b82f6);
  }
  .petition-content p {
    font-size: 14px;
    color: #64748b;
    margin: 0 0 16px;
    line-height: 1.6;
  }
  .petition-progress {
    margin-bottom: 16px;
  }
  .progress-bar {
    height: 8px;
    background: #e2e8f0;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 8px;
  }
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary-color, #3b82f6), #10b981);
    border-radius: 4px;
  }
  .progress-info {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    color: #64748b;
  }
  .signatures-count strong {
    color: var(--primary-color, #3b82f6);
    font-size: 14px;
  }
  .btn-sign {
    display: block;
    width: 100%;
    padding: 12px;
    background: var(--primary-color, #3b82f6);
    color: #fff;
    text-align: center;
    border-radius: 8px;
    font-weight: 600;
    text-decoration: none;
    transition: background 0.2s;
  }
  .btn-sign:hover {
    background: #1d4ed8;
    color: #fff;
  }
  .pagination-nav {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-top: 40px;
    padding: 20px;
  }
  .page-link {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 10px 20px;
    background: #fff;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    color: #475569;
    text-decoration: none;
    font-weight: 500;
    transition: all 0.2s;
  }
  .page-link:hover {
    background: var(--primary-color, #3b82f6);
    color: #fff;
    border-color: var(--primary-color, #3b82f6);
  }
  .page-info {
    color: #64748b;
    font-size: 14px;
  }
  .empty-state {
    text-align: center;
    padding: 80px 20px;
    background: #fff;
    border-radius: 12px;
  }
  .empty-state i {
    font-size: 64px;
    color: #cbd5e1;
    margin-bottom: 20px;
    display: block;
  }
  .empty-state h3 {
    font-size: 1.25rem;
    color: #475569;
    margin: 0 0 8px;
  }
  .empty-state p {
    color: #64748b;
    margin: 0 0 20px;
  }
  @media (max-width: 768px) {
    .petitions-hero h1 { font-size: 1.75rem; }
    .petitions-hero { padding: 40px 0; }
    .filters-form { flex-direction: column; }
    .filter-categories { justify-content: center; }
    .search-box { width: 100%; }
    .petitions-grid { grid-template-columns: 1fr; }
  }
</style>

`}) %>
